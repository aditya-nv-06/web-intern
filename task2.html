<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Vanilla JS To-Do List with CRUD + localStorage</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #f4f7f6;
    margin: 0;
    padding: 20px;
    display: flex;
    justify-content: center;
  }
  #todo-app {
    background: white;
    padding: 20px;
    border-radius: 8px;
    width: 320px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.2);
  }
  #todo-app h2 {
    margin-top: 0;
    text-align: center;
  }
  #new-todo-form {
    display: flex;
    margin-bottom: 20px;
  }
  #new-todo {
    flex: 1;
    padding: 10px;
    font-size: 16px;
    border: 1px solid #ccc;
    border-radius: 4px 0 0 4px;
    outline: none;
  }
  #add-btn {
    background: #28a745;
    color: white;
    border: none;
    padding: 10px 18px;
    cursor: pointer;
    font-size: 16px;
    border-radius: 0 4px 4px 0;
  }
  #add-btn:hover {
    background: #218838;
  }
  ul#todo-list {
    list-style-type: none;
    padding-left: 0;
    margin: 0;
  }
  ul#todo-list li {
    background: #e9ecef;
    margin-bottom: 10px;
    padding: 10px 12px;
    border-radius: 4px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  ul#todo-list li.completed {
    text-decoration: line-through;
    color: #6c757d;
  }
  button.edit, button.delete, button.save, button.cancel {
    border: none;
    padding: 6px 10px;
    margin-left: 6px;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
  }
  button.edit {
    background: #007bff;
    color: white;
  }
  button.edit:hover {
    background: #0056b3;
  }
  button.delete {
    background: #dc3545;
    color: white;
  }
  button.delete:hover {
    background: #a71d2a;
  }
  button.save {
    background: #28a745;
    color: white;
  }
  button.save:hover {
    background: #1e7e34;
  }
  button.cancel {
    background: #6c757d;
    color: white;
  }
  button.cancel:hover {
    background: #545b62;
  }
  input.edit-input {
    flex: 1;
    padding: 6px;
    font-size: 16px;
  }
</style>
</head>
<body>
<div id="todo-app">
  <h2>To-Do List</h2>
  <form id="new-todo-form">
    <input type="text" id="new-todo" placeholder="Add new task..." autocomplete="off" />
    <button type="submit" id="add-btn">Add</button>
  </form>
  <ul id="todo-list"></ul>
</div>

<script>
  const todoForm = document.getElementById('new-todo-form');
  const todoInput = document.getElementById('new-todo');
  const todoList = document.getElementById('todo-list');

  // Load todos from localStorage or start with an empty array
  let todos = JSON.parse(localStorage.getItem('todos')) || [];

  // Save todos to localStorage
  function saveTodos() {
    localStorage.setItem('todos', JSON.stringify(todos));
  }

  // Render the todo list
  function renderTodos() {
    todoList.innerHTML = '';
    todos.forEach((todo, index) => {
      const li = document.createElement('li');
      li.className = todo.completed ? 'completed' : '';
      
      if (todo.editing) {
        // Edit mode: show input with save and cancel
        const editInput = document.createElement('input');
        editInput.type = 'text';
        editInput.className = 'edit-input';
        editInput.value = todo.text;
        
        const saveBtn = document.createElement('button');
        saveBtn.textContent = 'Save';
        saveBtn.className = 'save';
        saveBtn.onclick = () => {
          const val = editInput.value.trim();
          if (val) {
            todos[index].text = val;
            todos[index].editing = false;
            saveTodos();
            renderTodos();
          } else {
            alert('Task cannot be empty.');
          }
        };

        const cancelBtn = document.createElement('button');
        cancelBtn.textContent = 'Cancel';
        cancelBtn.className = 'cancel';
        cancelBtn.onclick = () => {
          todos[index].editing = false;
          renderTodos();
        };

        li.appendChild(editInput);
        li.appendChild(saveBtn);
        li.appendChild(cancelBtn);
      } else {
        // Display mode: show text and buttons
        const span = document.createElement('span');
        span.textContent = todo.text;
        span.style.flex = "1";
        span.style.cursor = "pointer";
        span.onclick = () => {
          todos[index].completed = !todos[index].completed;
          saveTodos();
          renderTodos();
        };

        const editBtn = document.createElement('button');
        editBtn.textContent = 'Edit';
        editBtn.className = 'edit';
        editBtn.onclick = () => {
          todos[index].editing = true;
          renderTodos();
        };

        const deleteBtn = document.createElement('button');
        deleteBtn.textContent = 'Delete';
        deleteBtn.className = 'delete';
        deleteBtn.onclick = () => {
          todos.splice(index, 1);
          saveTodos();
          renderTodos();
        };

        li.appendChild(span);
        li.appendChild(editBtn);
        li.appendChild(deleteBtn);
      }
      todoList.appendChild(li);
    });
  }

  // Handle form submission for new todos
  todoForm.onsubmit = function(e) {
    e.preventDefault();
    const text = todoInput.value.trim();
    if (text) {
      todos.push({ text, completed: false, editing: false });
      saveTodos();
      renderTodos();
      todoInput.value = '';
      todoInput.focus();
    } else {
      alert('Please enter a task.');
    }
  };

  // Initial render on page load
  renderTodos();
</script>
</body>
</html>

